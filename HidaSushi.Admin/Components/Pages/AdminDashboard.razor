@page "/admin"
@attribute [Authorize]
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateProvider AuthStateProvider

<PageTitle>Admin Dashboard - HIDA SUSHI</PageTitle>

<div class="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 relative overflow-hidden">
    <!-- Animated background shapes -->
    <div class="absolute inset-0 overflow-hidden">
        <div class="absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"></div>
        <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"></div>
        <div class="absolute top-40 left-40 w-80 h-80 bg-indigo-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"></div>
    </div>

    <!-- Header Section -->
    <div class="relative z-10 bg-gradient-to-r from-royal-purple via-pink-primary to-deep-purple shadow-professional">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm animate-bounce">
                        <span class="text-3xl">üç£</span>
                    </div>
                    <div>
                        <h1 class="text-4xl font-bold text-white mb-2 font-poppins">HIDA SUSHI</h1>
                        <p class="text-light-purple text-lg font-inter">Admin Dashboard</p>
                        @if (!string.IsNullOrEmpty(currentUser))
                        {
                            <p class="text-sm text-white/80 mt-1 font-inter">Welcome back, @currentUser</p>
                        }
                    </div>
                </div>
                <div class="hidden md:flex items-center space-x-4">
                    <div class="text-right text-white">
                        <p class="text-sm opacity-80 font-inter">@DateTime.Now.ToString("MMMM dd, yyyy")</p>
                        <p class="text-lg font-semibold font-poppins">@DateTime.Now.ToString("HH:mm")</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Dashboard Stats -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Total Orders Card -->
            <div class="glass-effect rounded-2xl shadow-professional p-6 transform transition-all duration-300 hover:scale-105 hover-glow">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-300 font-inter">Total Orders</p>
                        <p class="text-3xl font-bold text-white font-poppins">@totalOrders</p>
                        <p class="text-sm text-green-400 mt-1 font-inter">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                </svg>
                                +12% from last month
                            </span>
                        </p>
                    </div>
                    <div class="w-12 h-12 bg-purple-500/30 rounded-full flex items-center justify-center backdrop-blur-sm">
                        <span class="text-2xl">üìä</span>
                    </div>
                </div>
            </div>

            <!-- Today's Revenue Card -->
            <div class="glass-effect rounded-2xl shadow-professional p-6 transform transition-all duration-300 hover:scale-105 hover-glow">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-300 font-inter">Today's Revenue</p>
                        <p class="text-3xl font-bold text-white font-poppins">‚Ç¨@todayRevenue.ToString("F2")</p>
                        <p class="text-sm text-green-400 mt-1 font-inter">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                </svg>
                                +8% from yesterday
                            </span>
                        </p>
                    </div>
                    <div class="w-12 h-12 bg-green-500/30 rounded-full flex items-center justify-center backdrop-blur-sm">
                        <span class="text-2xl">üí∞</span>
                    </div>
                </div>
            </div>

            <!-- Menu Items Card -->
            <div class="glass-effect rounded-2xl shadow-professional p-6 transform transition-all duration-300 hover:scale-105 hover-glow">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-300 font-inter">Menu Items</p>
                        <p class="text-3xl font-bold text-white font-poppins">@totalMenuItems</p>
                        <p class="text-sm text-blue-400 mt-1 font-inter">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v3.586L7.707 9.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 10.586V7z" clip-rule="evenodd"></path>
                                </svg>
                                3 new this week
                            </span>
                        </p>
                    </div>
                    <div class="w-12 h-12 bg-blue-500/30 rounded-full flex items-center justify-center backdrop-blur-sm">
                        <span class="text-2xl">üç£</span>
                    </div>
                </div>
            </div>

            <!-- Pending Orders Card -->
            <div class="glass-effect rounded-2xl shadow-professional p-6 transform transition-all duration-300 hover:scale-105 hover-glow">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-300 font-inter">Pending Orders</p>
                        <p class="text-3xl font-bold text-white font-poppins">@pendingOrders</p>
                        <p class="text-sm text-orange-400 mt-1 font-inter">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                                </svg>
                                Needs attention
                            </span>
                        </p>
                    </div>
                    <div class="w-12 h-12 bg-orange-500/30 rounded-full flex items-center justify-center backdrop-blur-sm">
                        <span class="text-2xl">‚è∞</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions Section -->
        <div class="glass-effect rounded-2xl shadow-professional p-8 mb-8">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-white font-poppins">Quick Actions</h3>
                <div class="w-12 h-1 bg-gradient-to-r from-royal-purple to-pink-primary rounded-full"></div>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <a href="/menu-management" class="bg-white/10 backdrop-blur-sm hover:bg-white/20 rounded-xl p-6 border border-white/20 transition-all duration-300 transform hover:scale-105 hover:shadow-glow">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-purple-500/30 rounded-full flex items-center justify-center mr-4 backdrop-blur-sm">
                            <span class="text-2xl">üç£</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-white font-poppins">Manage Menu</h4>
                            <p class="text-sm text-gray-300 font-inter">Add & edit items</p>
                        </div>
                    </div>
                </a>

                <a href="/orders" class="bg-white/10 backdrop-blur-sm hover:bg-white/20 rounded-xl p-6 border border-white/20 transition-all duration-300 transform hover:scale-105 hover:shadow-glow">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-blue-500/30 rounded-full flex items-center justify-center mr-4 backdrop-blur-sm">
                            <span class="text-2xl">üìã</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-white font-poppins">View Orders</h4>
                            <p class="text-sm text-gray-300 font-inter">Track & manage</p>
                        </div>
                    </div>
                </a>

                <a href="/ingredient-management" class="bg-white/10 backdrop-blur-sm hover:bg-white/20 rounded-xl p-6 border border-white/20 transition-all duration-300 transform hover:scale-105 hover:shadow-glow">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-green-500/30 rounded-full flex items-center justify-center mr-4 backdrop-blur-sm">
                            <span class="text-2xl">ü•ï</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-white font-poppins">Ingredients</h4>
                            <p class="text-sm text-gray-300 font-inter">Inventory control</p>
                        </div>
                    </div>
                </a>

                <a href="/analytics" class="bg-white/10 backdrop-blur-sm hover:bg-white/20 rounded-xl p-6 border border-white/20 transition-all duration-300 transform hover:scale-105 hover:shadow-glow">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-yellow-500/30 rounded-full flex items-center justify-center mr-4 backdrop-blur-sm">
                            <span class="text-2xl">üìà</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-white font-poppins">Analytics</h4>
                            <p class="text-sm text-gray-300 font-inter">Performance data</p>
                        </div>
                    </div>
                </a>

                <a href="/weather" class="bg-white/10 backdrop-blur-sm hover:bg-white/20 rounded-xl p-6 border border-white/20 transition-all duration-300 transform hover:scale-105 hover:shadow-glow">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-sky-500/30 rounded-full flex items-center justify-center mr-4 backdrop-blur-sm">
                            <span class="text-2xl">üå§Ô∏è</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-white font-poppins">Weather</h4>
                            <p class="text-sm text-gray-300 font-inter">Local forecast</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>

        <!-- Recent Activity Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Recent Orders -->
            <div class="glass-effect rounded-2xl shadow-professional p-6">
                <div class="flex items-center justify-between mb-6">
                    <h4 class="text-xl font-bold text-white font-poppins">Recent Orders</h4>
                    <span class="bg-blue-500/20 text-blue-300 text-xs font-semibold px-3 py-1 rounded-full border border-blue-500/30 font-inter">Live</span>
                </div>
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-3 bg-white/10 rounded-lg hover:bg-white/20 transition-colors border border-white/20">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-green-500/30 rounded-full flex items-center justify-center backdrop-blur-sm">
                                <span class="text-white text-sm font-bold">#</span>
                            </div>
                            <div>
                                <p class="font-medium text-white font-inter">Order #12345</p>
                                <p class="text-sm text-gray-300 font-inter">2 minutes ago</p>
                            </div>
                        </div>
                        <span class="text-green-400 font-semibold font-poppins">‚Ç¨24.99</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-white/10 rounded-lg hover:bg-white/20 transition-colors border border-white/20">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-blue-500/30 rounded-full flex items-center justify-center backdrop-blur-sm">
                                <span class="text-white text-sm font-bold">#</span>
                            </div>
                            <div>
                                <p class="font-medium text-white font-inter">Order #12344</p>
                                <p class="text-sm text-gray-300 font-inter">5 minutes ago</p>
                            </div>
                        </div>
                        <span class="text-green-400 font-semibold font-poppins">‚Ç¨18.50</span>
                    </div>
                </div>
                <button class="w-full mt-4 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-all duration-200 font-poppins">
                    View All Orders
                </button>
            </div>

            <!-- System Status -->
            <div class="glass-effect rounded-2xl shadow-professional p-6">
                <div class="flex items-center justify-between mb-6">
                    <h4 class="text-xl font-bold text-white font-poppins">System Status</h4>
                    <span class="bg-green-500/20 text-green-300 text-xs font-semibold px-3 py-1 rounded-full border border-green-500/30 font-inter">All Good</span>
                </div>
                <div class="space-y-4">
                    <div class="flex items-center justify-between">
                        <span class="text-gray-300 font-inter">API Status</span>
                        <div class="flex items-center space-x-2">
                            <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                            <span class="text-green-400 font-medium font-inter">Online</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-gray-300 font-inter">Database</span>
                        <div class="flex items-center space-x-2">
                            <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                            <span class="text-green-400 font-medium font-inter">Connected</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-gray-300 font-inter">Payment Gateway</span>
                        <div class="flex items-center space-x-2">
                            <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                            <span class="text-green-400 font-medium font-inter">Active</span>
                        </div>
                    </div>
                </div>
                <div class="mt-4 p-3 bg-green-500/20 rounded-lg border border-green-500/30">
                    <p class="text-sm text-green-300 font-inter">All systems are running smoothly!</p>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private string currentUser = "";
    private int totalOrders = 0;
    private decimal todayRevenue = 0;
    private int totalMenuItems = 0;
    private int pendingOrders = 0;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await LoadDashboardData();
            StateHasChanged();
        }
    }

    private async Task LoadDashboardData()
    {
        try
        {
            var authState = await AuthStateProvider.GetAuthenticationStateAsync();
            if (authState.User.Identity?.IsAuthenticated == true)
            {
                currentUser = authState.User.Identity.Name ?? "Admin";
            }

            // Mock stats for now
            totalOrders = 156;
            todayRevenue = 2489.50m;
            totalMenuItems = 42;
            pendingOrders = 8;
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading dashboard data: {ex.Message}");
        }
    }
} 